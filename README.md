บิตคอยน์มี 21 ล้านบิคบิตคอยน์จริงไหม? มาพิสูจน์กัน

ใครๆก็เคยได้ยินใช่ไหมว่าเขาว่ากันว่า บิตคอยน์มันมี "จำกัดจำนวน 21 ล้านบิตคอยน์" แต่ในโค้ดของ Bitcoin Core ไม่ได้ระบุว่าเป็น 21 ล้านโดยตรง สิ่งที่จำกัดจำนวนบิตคอยน์ไว้ที่ไม่เกิน 21 ล้าน มาจากโค้ดแค่ 6 บรรทัดที่คำนวณการจ่ายรางวัลบล็อก (block subsidy) ซึ่งโค้ดนี้อยู่ในไฟล์ `validation.cpp` ในโฟลเดอร์ `bitcoin/src/` ของ Bitcoin Core
หน้าตาโค้ดดูได้ในรูปที่ 1 หรือเข้าไปดูใน
ลิงค์: https://github.com/bitcoin/bitcoin/blob/f07a533dfcb172321972e5afb3b38a4bd24edb87/src/validation.cpp#L1912ห

โค้ดนี้จะทำการตรวจสอบการ Halving (การลดรางวัลบล็อกลงครึ่งหนึ่ง) และคำนวณรางวัลบล็อกที่จะจ่ายให้กับนักขุด โดยตอนนี้ Halving เกิดขึ้นไปแล้ว 3 ครั้ง ทำให้รางวัลบล็อกเหลือแค่ 3.125 BTC เท่านั้น! โค้ดนี้สามารถทำให้เกิดการ Halving ได้สูงสุด 33 ครั้ง หรือประมาณ 132 ปีข้างหน้า! 

มาดูการทำงานของโค้ด GetBlockSubsidy ใน Bitcoin Core กันดีกว่า! ด้วยโค้ดนี้เราสามารถคำนวณบิตคอยน์ที่จะถูกขุดในแต่ละวันได้อย่างแม่นยำ ทำให้จำนวนบิตคอยน์ทั้งหมดคือผลรวมของบิตคอยน์ที่ถูกขุดขึ้นมา และถ้าอยากเพิ่มจำนวนบิตคอยน์ล่ะก็ ต้องไปแก้ไขโค้ดนี้ซึ่งผู้ถือบิตคอยน์ส่วนใหญ่ไม่ยอมให้เปลี่ยนแน่นอน!

มาดูวิธีการทำงานของโค้ดกันเลย:
- nHeight: ความสูงของบล็อกปัจจุบัน เช่น 850,000
- nSubsidyHalvingInterval: จำนวนบล็อกที่ต้องเกิดขึ้นก่อน Halving แต่ละครั้ง คือ 210,000 บล็อก
- COIN: ค่าคงที่ที่กำหนด Satoshi ต่อ 1 บิตคอยน์ที่ 100,000,000
- nSubsidy: รางวัลบล็อกที่คำนวณได้จากฟังก์ชันนี้

ในบรรทัดแรก จำนวนการ Halving จะคำนวณโดยการหารความสูงของบล็อก "nHeight" ด้วยช่วง Halving "nSubsidyHalvingInterval" เช่น ถ้าบล็อกปัจจุบันคือ 850,000:

850,000 / 210,000 = 4.047619048

เนื่องจากตัวแปรนี้เป็นจำนวนเต็ม int(integer) จะตัดทศนิยมทิ้ง เหลือเพียง 4 หลังจากนั้นในบรรทัด 1675 และ 1677 จะคำนวณรางวัลบล็อก "nSubsidy" โดยใช้รางวัลเริ่มต้น 50 BTC และแปลงเป็น Satoshi ด้วยการคูณด้วย "COIN" (100,000,000):

50 * 100,000,000 = 5,000,000,000

จากนั้นจะหารครึ่งโดยการบิตซิฟไปทางขวา (right shift) ตามจำนวนการ Halving ที่คำนวณไว้คือ 4 ครั้ง:

5,000,000,000 / 2 / 2 / 2 / 2 = 312,500,000 Satoshi = 3.125 BTC คือรางวัลบล็อกปัจจุบัน

เมื่อเวลาผ่านไป ความสูงของบล็อกเพิ่มขึ้น รางวัลบล็อกจะถูกหารครึ่งซ้ำ ๆ จนกว่าจะถึงจุดที่รางวัลเหลือแค่ 1 Satoshi (0.00000001 BTC) และในที่สุดจะเหลือ 0 Satoshi!

มาพิสูจน์ด้วยโค้ด Python กันดีกว่า ว่ามันจริงอย่างที่เขากว่ากันไหม
บล็อกที่ 6,930,000 เหรียญที่ขุดได้จะเป็น 0 หมายความว่าจะ ไม่มีเหรียญใหม่ขุดเพิ่มได้อีกแล้ว หรือ โบนัสของนักขุดหมดแล้ว เพราะ Subsidy ก็คือ แรงจูงใจ, รางวัล 

เอ้าแล้วถ้ามันขุดไม่ได้แล้ว ใครมันจะเอาไฟฟ้าไปขุดทิ้งหละ ระบบล่มแน่ๆ เพราะไม่มีคนคอยปิดบล็อกให้ ต้องบอกว่านักขุดยังได้ค่าธรรมเนียมจากการทำธุรกรรมได้อยู่ดี เมื่อถึงตอนนั้นบิตคอยน์คงมีมูลลค่าสูงมาก เพราะมันมีจำนวนจำกัดนั้นแหละ Subsidy จะกลายแค่เด็กๆไปเลย ซาโตชิเค้าออกแบบมานั้น เพราะช่วงแรกมันยังไม่มีมูลค่าเลยต้องให้นักขุดมีแรงจูงใจ เพื่อทำความระบบแข็งแกร่งขึ้นนั้นเอง

เมื่อโค้ดเราเราเขียนรันเสร็จก็จะได้ผลลัพท์ว่า
2,099,999,997,690,000 เห้ยทำไม่มันไม่ใช่ 21 ล้านวะ อ๋อมันเป็นหน่วยซาโตชินะ 2,099,999,997,690,000 / 100,000,000 แต่ถ้าเราแปลงเป็นบิตคอยน์ก็จะเกือบถึง 21 ล้านนั่นแหละ

บิตคอยน์มีประมาณ 21 ล้าน นั้นเป็น "เรื่องจริง" 

แล้วถ้าถามว่ามีแค่นั้นมันจะพอหรอ เอ่อผมว่ามันพอแน่นอน ถ้าแบ่งเป็นหน่วยซาโตชิก็จะได้ "สองพันเก้าสิบเก้าล้านล้าน เก้าแสนเก้าหมื่นเก้าพันเก้าร้อยเก้าสิบเจ็ดล้าน หกแสนเก้าหมื่น" ซาโตชิ
2 Quadrillion ในภาษาไทยแปลว่า พันล้านล้าน หรือ 10^15 1 ตามด้วยเลขศูนย์ 15 ตัว ต้องพอแล้วแหละ

ต้องบอก่อนว่า ไม่ได้มีเจตนาชวนลงทุนนะครับ เดี๋ยวกลด.เล่นกูอีก
ขอบคุณที่อ่านจนจบครับ สวัสดีครับ

ไม่เชื่อก็เอาโค้ดที่ผมเขียนไปรันเองได้